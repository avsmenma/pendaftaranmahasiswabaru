<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style/register.css" />
    <title>Pendaftaran Mahasiswa Baru</title>
  </head>
  <body>
    <div class="container">
      <!-- Left Section -->
      <div class="left-section">
        <div class="header">
          <h1>
            SISTEM PENDATAAN PENERIMAAN MAHASISWA BARU<br />POLITEKNIK NEGERI
            PONTIANAK
          </h1>
          <p>
            Platform terpadu untuk pengelolaan data penerimaan mahasiswa baru
            yang efisien dan transparan
          </p>
        </div>

        <div class="footer">
          <p>@ 2025 Sistem Penerimaan Mahasiswa Baru. All rights reserved</p>
        </div>
      </div>

      <!-- Right Section -->
      <div class="right-section">
        <div class="register-container">
          <div class="register-header">
            <h2>Buat Akun Baru</h2>
            <p>Isi formulir di bawah ini untuk membuat akun baru</p>
          </div>

          <form id="register-form">
            <div class="form-group">
              <label for="email">Email</label>
              <input
                type="email"
                id="email"
                class="form-control"
                placeholder="Masukkan email"
                required
              />
            </div>

            <div class="form-group">
              <label for="nama">Nama Lengkap</label>
              <input
                type="text"
                id="nama"
                class="form-control"
                placeholder="Masukkan Nama Lengkap Anda"
                required
              />
            </div>

            <div class="form-group">
              <label for="password">Kata Sandi</label>
              <input
                type="password"
                id="password"
                class="form-control"
                placeholder="Masukkan password"
                required
              />
              <p class="password-hint">
                Gunakan kombinasi huruf besar, kecil, dan angka
              </p>
            </div>

            <div class="form-group">
              <label for="confirm-password">Konfirmasi Kata Sandi</label>
              <input
                type="password"
                id="confirm-password"
                class="form-control"
                placeholder="Masukkan password"
                required
              />
            </div>

            <div class="terms-checkbox">
              <input type="checkbox" id="terms" required />
              <label for="terms"
                >Saya menyetujui <a href="#">Syarat dan Ketentuan</a> serta
                <a href="#">Kebijakan Privasi</a></label
              >
            </div>

            <button type="submit" class="btn-register">Daftar Sekarang</button>
          </form>

          <div class="login-link">
            <p>Sudah punya akun? <a href="index.html">Masuk disini</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
      <i class="fas fa-check-circle"></i>
      <div>
        <p id="notification-title">Berhasil</p>
        <p id="notification-message">Pendaftaran berhasil</p>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const registerForm = document.getElementById("register-form");
        registerForm.addEventListener("submit", async function (e) {
          e.preventDefault();

          const email = document.getElementById("email").value;
          const namaLengkap = document.getElementById("nama").value;
          const password = document.getElementById("password").value;
          const confirmPassword =
            document.getElementById("confirm-password").value;
          const terms = document.getElementById("terms").checked;

          // Validasi dasar
          if (!email || !namaLengkap || !password || !confirmPassword) {
            showNotification("error", "Error", "Mohon lengkapi semua field");
            return;
          }
          if (password !== confirmPassword) {
            showNotification(
              "error",
              "Error",
              "Password dan konfirmasi password tidak cocok"
            );
            return;
          }
          if (password.length < 8) {
            showNotification("error", "Error", "Password minimal 8 karakter");
            return;
          }
          const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/;
          if (!passwordRegex.test(password)) {
            showNotification(
              "error",
              "Error",
              "Password harus mengandung huruf besar, huruf kecil, dan angka"
            );
            return;
          }

          if (!terms) {
            showNotification(
              "error",
              "Error",
              "Anda harus menyetujui syarat dan ketentuan"
            );
            return;
          }

          try {
            // Kirim data ke server.js
            const response = await fetch("/api/register", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                email,
                namaLengkap,
                password,
                confirmPassword,
              }),
            });

            const data = await response.json();

            if (data.success) {
              showNotification("success", "Berhasil", data.message);
              setTimeout(() => {
                window.location.href = "index.html";
              }, 2000);
            } else {
              showNotification("error", "Gagal", data.message);
            }
          } catch (err) {
            console.error("Error:", err);
            showNotification("error", "Error", "Gagal menghubungi server");
          }
        });
      });

      // Fungsi notifikasi tetap sama
      function showNotification(type, title, message) {
        const notification = document.getElementById("notification");
        const icon = notification.querySelector("i");
        const titleElement = document.getElementById("notification-title");
        const messageElement = document.getElementById("notification-message");

        titleElement.textContent = title;
        messageElement.textContent = message;
        notification.className = "notification " + type;

        if (type === "success") {
          icon.className = "fas fa-check-circle";
        } else if (type === "error") {
          icon.className = "fas fa-exclamation-circle";
        }

        notification.classList.add("show");
        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }
    </script>
  </body>
</html>
